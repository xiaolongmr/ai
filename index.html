<!--
 * @Author: zl88 zhang1932@foxmail.com
 * @Date: 2023-04-16 16:32:16
 * @LastEditors: error: error: git config user.name & please set dead value or install git && error: git config user.email & please set dead value or install git & please set dead value or install git
 * @LastEditTime: 2023-06-15 17:32:57
 * @FilePath: \public\index.html
 * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->
<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset=UTF-8>
    <meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5">
    <title>AI导航站</title>
    <link rel="shortcut icon" href="https://zlcy.cf/gh/xiaolongmr/test@main/1.png" type="image/x-icon">
    <link rel="apple-touch-icon" href="https://zlcy.cf/gh/xiaolongmr/test@main/1.png">
    <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://zlcy.cf/gh/xiaolongmr/test@main/1.png">
    <meta name="apple-mobile-web-app-title" content="小张和小陈💕">
    <meta name=description content="大三视传人自制，方便自己已经朋友而存在的导航网站AI导航-设计师必备导航站">
    <meta name=keywords content="AI,AI站,视传导航网,设计导航网,AI导航,AI导航站">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/favicon.ico">
    <meta name="apple-mobile-web-app-title" content="AI导航">
    <link rel="shortcut icon" href=/favicon.ico type=image/x-icon>
    <link rel=stylesheet href=css/style.css>
    <link rel=stylesheet href=css/tubiao.css>
    <link href=css/main_search.css rel=stylesheet>
    <link href=css/root.css rel=stylesheet>
    <script src='https://fastly.jsdelivr.net/gh/xiaolongmr/test@main/js/jquery.min.js'></script>
    <!-- 最新引入的js -->
    <script type="text/javascript" src="js/main.js"></script>
    <script src="https://unpkg.com/xlsx@0.17.2/dist/xlsx.full.min.js"></script>
    <style>
        /* 站长推荐去除logo */
        
        .box:nth-child(6) img {
            display: none;
        }
        
        .box:nth-child(6) .item .logo {
            height: 30px;
            line-height: 30px;
            font-weight: 400;
        }
        
        .main .box:nth-child(6) .item .desc {
            padding-top: 0px;
            height: 30px;
        }
        
        .main div:nth-child(n)>a>.gpt {
            background: var(--BoxItemBackground-color), url(https://3o.hk/images/2023/03/29/gpt.png) 99% 100% no-repeat;
            background-size: 32%;
            background-position: 0 100%, 100% 100%
        }
        
        .main div:nth-child(n)>a>.zijiren {
            background: var(--BoxItemBackground-color), url(https://pic.zhaotu.me/2023/03/24/-1c326616c9b761482.png) 99% 100% no-repeat;
            background-size: 31%;
            background-position: 0 100%, 100% 100%
        }
        
        .main div:nth-child(n)>a>.djtj {
            background: var(--BoxItemBackground-color), url(https://3o.hk/images/2023/04/17/22.png) 99% 100% no-repeat;
            background-size: 31%;
            background-position: 0 100%, 100% 100%
        }
        
        .main div:nth-child(n)>a>.djtj:hover {
            background: var(--BoxItemBackground-color), url(https://3o.hk/images/2023/04/17/1a6c2d583403edb00.png) 99% 100% no-repeat;
            background-size: 31%;
            background-position: 0 100%, 100% 100%
        }
        
        .main div:nth-child(11)>a>.xztj {
            background: var(--BoxItemBackground-color), url(https://3o.hk/images/2023/04/17/33.png) 99% 100% no-repeat;
            background-size: 20%;
            background-position: 0 100%, 140% 100%
        }
        
        .main div:nth-child(11)>a:hover .xztj {
            background-position: 0 100%, 100% 100%
        }
        /* 友情链接去除logo */
        
        .box:nth-child(21) img {
            display: none;
        }
        
        .box:nth-child(21) .item .logo {
            height: 30px;
            line-height: 30px;
            font-weight: 400;
        }
    </style>
</head>

<body>
    <!-- 护眼模式按键输入end -->
    <div class="container" id="container">
        <!-- 左边导航栏 -->
        <aside class=left-bar id=leftBar>
            <div class=title>
                <a href=# rel=noopener title=关于本站 onclick="document.getElementById('dome').innerHTML=obj.sites[0].hello">
                    <i class=jiaran></i></a>
                <!-- h1是方便搜索引擎,设置隐藏` -->
                <h1 style='display:none'>AI导航站</h1><a target=_blank rel=noopener href="https://cn.bing.com/search?q=%E5%A4%8Fdj%E5%AF%BC%E8%88%AA">AI-导航站</a>
            </div>
            <nav class=nav>
                <div class="item active"><i class="iconfont icon-shoucangbenzhan"></i>
                    <a href=javascript:; onclick=addFavorite(this)>✨点我收藏本站👈</a>
                    <i class=line></i></div>
                <ul class=nav-item id=navItem>
                    <li><a href=#nice class=active><i class="iconfont icon-like-fill"></i>最推荐</a></li>
                    <li><a href=#teacher><i class="iconfont icon-shuzhuangtu"></i>AI模型</a></li>
                    <li><a href=#docs><i class="iconfont icon-jingxuan"></i>提示词</a></li>
                    <li><a href=#designweb><i class="iconfont icon-shejishi"></i>AI社区</a></li>
                    <!-- <li><a href=#color><i class="iconfont icon-peise"></i>配色网站</a></li>
                    <li><a href=#chajian><i class="iconfont icon-annex"></i>软件插件</a></li>
                    <li><a href=#book><i class="iconfont icon-ziliaoku"></i>书籍资源</a></li>
                    <li><a href=#zonghe><i class="iconfont icon-zongheziyuan"></i>综合资源</a></li>
                    <li><a href=#software><i class="iconfont icon-apply"></i>软件下载</a></li> -->
                    <li><a href=#bilibili><i class="iconfont icon-shipin"></i>B站up</a></li>
                    <li><a href=#chatgpt><i class="iconfont icon-bisai"></i>Chatgpt</a></li>
                    <li><a href=#aidh><i class="iconfont icon-soutu"></i>AI导航</a></li>
                    <li><a href=#web><i class="iconfont icon-gongju"></i>有趣网站</a></li>
                    <!-- <li><a href=#soutu><i class="iconfont icon-soutu"></i>在线搜图</a></li>
                    <li><a href=#tools><i class="iconfont icon-gongju"></i>在线工具</a></li>
                    <li><a href=#download><i class="iconfont icon-mianfei-xianxing"></i>资源下载</a></li>
                    <li><a href=#dissertation><i class="iconfont icon-lunwen"></i>毕业论文</a></li> -->
                </ul>
                <div class="item comment"><a target=_blank rel=noopener href='https://zl88.github.io/posts/56198.html'><i class="iconfont icon-gengxinrizhi"></i>更新日志</a>
                    <a class="number"></a>
                </div>
            </nav>
        </aside>
        <!-- 左边导航栏end -->
        <!-- 主体部分 -->
        <section id="main" class=main>
            <div id="mainContent">
                <div id=menu-box>
                    <div id=menu><input type=checkbox id=menu-form><label for=menu-form class=menu-spin><div class="line diagonal line-1"></div><div class="line horizontal"></div><div class="line diagonal line-2"></div></label></div>
                </div>
                <div class=header>
                    <nav>
                        <a target=_blank rel=noopener href="/">🔯使用指南</a>
                        <a href="/">📖评论留言</a>
                        <a href="/">👦关于本站</a></nav>
                </div>
                <!-- 搜索🔍模块 -->
                <div id=content>
                    <div class=con>
                        <section class=sousuo>
                            <div class=search>
                                <div class=search-box><i id=search-icon style="color:#3385ff;background:url(https://xiaolongmr.github.io/test/svg/bing.svg) no-repeat center/cover"></i> <input autocomplete=off class=search-input id=txt placeholder="&nbsp;选择换搜索引擎后请输入关键字" list="jiyi">
                                    <datalist class="box" id="jiyi">
                              <optgroup>
                                  <option value="他是谁"></option>
                                  <option value="重生之门"></option>
                                  <option value="淮海战役陈官庄纪念馆"></option>
                              </optgroup>
                          </datalist>
                                    <input id=search-clear style="background:url(https://1nav.ml/img/clear.svg) no-repeat center/cover;display:none">
                                    <button class=search-btn></button></div>
                                <div class="box search-hot-text" id=search-box style="display:none">
                                    <ul></ul>
                                </div>
                                <div class=search-engine style=" display:none ">
                                    <div class=search-engine-head>
                                        <strong class=" search-engine-tit ">选择搜索引擎：</strong>
                                        <div class=search-engine-tool>搜索热词：</div>
                                    </div>
                                    <ul class=search-engine-list></ul>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
                <!-- 搜索的js -->
                <script src=js/search.js></script>
                <!--  -->
                <!-- ✨简短公告和天气模块 -->
                <div class=box>
                    <a name=gonggao></a>

                    <div class=sub-category>
                        <div onclick=test4()>
                            <span id="dome" style="font-size: 1.2rem;">
                      <code>👋本网站由<span class=scr style="font-size: 1.2rem;">AI绘画</span>爱好者制作，方便自己和朋友而存在的一个ai绘画导航网站<span> 
                  </span>
                            <i style="float:right;padding-right:1em;" id="tp-weather-widget">
                      <!-- 这里面是通过js添加的天气的内容 -->
                  </i>
                        </div>
                    </div>
                </div>

                <!-- 这里是excell表格的数据 -->

            </div>
            <!-- 🍀页脚模块 -->
            <script src="pages/footer.js "></script>
            <!-- 🍀 -->
        </section>
    </div>
    <!-- 🍀返回顶部和背景已经自适应pc和📱 -->
    <script src="pages/backtotop-bg.js"></script>
    <!-- 🍀 -->
    <!-- 尬聊 -->
    <script src=js/chat.js async="async " fold></script>
    <!--  -->
    <!-- 51la网站统计 -->
    <script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
    <script>
        LA.init({
            id: "K2FRAEqwdJ3Zqlj6",
            ck: "K2FRAEqwdJ3Zqlj6"
        })
    </script>
    <!-- 性能监控系统 -->
    <script src="https://sdk.51.la/perf/js-sdk-perf.min.js" crossorigin="anonymous"></script>
    <script>
        new LingQue.Monitor().init({
            id: "K2QGHIaETNJVc7Yp"
        });
    </script>
    <!--  -->
    <!-- Chat GPT 4 生成的 excell 分类网站转 html 代码 -->
    <script>
        const url = "2.xlsx";
        fetch(url)
            .then((res) => res.blob())
            .then((blob) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const data = e.target.result;
                    // 使用JS-XLSX库将Excel数据转换成JSON数组
                    const workbook = XLSX.read(data, {
                        type: "binary"
                    });
                    const sheet = workbook.Sheets[workbook.SheetNames[0]];
                    const json = XLSX.utils.sheet_to_json(sheet, {
                        header: 1
                    });
                    const mainContent = document.getElementById("mainContent");
                    // 遍历JSON数组，根据分类名和子分类名动态生成HTML元素，并将数据填充到HTML元素中
                    for (let n = 0; n < json[0].length; n += 6) {
                        const categoryName = json[0][n];
                        if (!categoryName) break;
                        const categoryValue = json[0][n + 1]; //分类的属性class
                        const boxicon = json[0][n + 2]; //每一个分类的图标。如果没有图标，则为空字符串
                        const box = document.createElement("div");
                        box.className = "box";
                        const anchor = document.createElement("a");
                        anchor.href = "#";
                        anchor.name = categoryValue;
                        box.appendChild(anchor);
                        const subCategory = document.createElement("div");
                        subCategory.className = "sub-category";
                        const subCategoryName = document.createElement("div");
                        subCategoryName.innerHTML = `<i class="${boxicon}"></i>${categoryName}`;
                        subCategory.appendChild(subCategoryName);
                        box.appendChild(subCategory);
                        for (let i = 1; i < json.length; i++) {
                            const rowData = json[i];
                            const name = rowData[n];
                            if (!name) break;
                            const url = rowData[n + 1];
                            const icon = rowData[n + 2];
                            const desc = rowData[n + 3];
                            const attr = rowData[n + 4];
                            const itemWrapper = document.createElement("div");
                            const itemLink = document.createElement("a");
                            itemLink.target = "_blank";
                            itemLink.href = url;
                            const item = document.createElement("div");
                            item.className = `item ${attr}`;
                            const logo = document.createElement("div");
                            logo.className = "logo";
                            // logo.innerHTML = `<img src="${icon}"> ${name}`;  //这是原来的
                            // logo.innerHTML = `<img src="https://ico.kucat.cn/get.php?url=${url}"> ${name}`;  //这个是利用网站icon API获取logo 但是大多是不能展示，所以弃用
                            if (icon) { // 如果icon不为空 
                                logo.innerHTML = `<img loading="lazy" src ="${icon}"> ${name}`;
                            } else { // 如果icon为空 
                                let newUrl = url.replace(/^http(s)?:\/\//i, "");
                                // logo.href = newUrl;
                                logo.innerHTML = `<img loading="lazy" src ="https://api.iowen.cn/favicon/${newUrl}.png">  ${name}`; //中间的空格是让logo和name有距离
                            };
                            item.appendChild(logo);
                            const description = document.createElement("div");
                            description.className = "desc";
                            description.id = 'description';

                            // 下面这个自动获取网站描述的好像没效果
                            if (desc) {
                                description.innerHTML = `${desc}`; //如果不为空则显示，excell表格里的描述
                            } else {
                                fetch(`${url}`)
                                    .then((response) => response.text())
                                    .then((html) => {
                                        const doc = new DOMParser().parseFromString(html, "text/html");
                                        const desc1 = doc.querySelector("meta[name='description']");
                                        const pageDesc = desc1 ? desc1.getAttribute("content") : "";
                                        description.innerHTML = pageDesc; // 将获取到的描述信息赋值给页面元素
                                    });
                            }
                            // 网站描述获取

                            // description.innerHTML = `${desc}`;
                            //   description.textContent = desc; 上面代码替换了这个
                            item.appendChild(description);
                            itemLink.appendChild(item);
                            itemWrapper.appendChild(itemLink);
                            box.appendChild(itemWrapper);
                        }
                        // 将生成的HTML代码插入到页面中
                        mainContent.appendChild(box);
                    }
                };
                reader.readAsBinaryString(blob);
            });
    </script>


    <script>
        // 网站收录数量
        window.onload = function() {
            // 获取class为logo的元素数量
            var logoNum = document.getElementsByClassName('logo').length - 7;
            // 将数量打印到页面上
            document.getElementsByClassName('number')[0].innerHTML = '   网站数:' + logoNum;
        }
    </script>
</body>

</html>
</script>
</body>

</html>